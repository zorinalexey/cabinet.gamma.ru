@php use Illuminate\Support\Facades\Auth; @endphp
@extends('layouts.cabinet')
@section('title', 'Документы')

@section('script')
    <script src="/js/tabs.js"></script>
@endsection

@section('content')
    <div class="content-body overflow-hidden">
        <div class="row">
            <div class="breadcrumbs">
                <div class="breadcrumbs-item">
                    <a href="{{route('cabinet')}}">Личный кабинет</a>
                </div>
                <div class="separator">|</div>
                <div class="breadcrumbs-item">
                    <a href="{{route('documents')}}">Документы</a>
                </div>
            </div>
        </div>
        <div class="row m-0">
            <div class="tabs two-tabs">
                <div id="1" class="tab-item active">Все документы</div>
                @if($count = (count(Auth::user()->getNoSignDocuments()) > 0))
                    <div id="2" class="tab-item">
                    <span>
                        Документы на подпись
                        <!--Если есть документы на подпись-->
                        <div class="notifications-count">{{count(Auth::user()->getNoSignDocuments())}}</div>
                    </span>
                    </div>
                @endif
            </div>
        </div>
        <div class="row m-0">
            <div id="tab-content1" class="tab-content doc-tabs green-panels active">
                @foreach($documents as $document)
                    <div class="row  m-0 doc-row">
                        <div class="doc-name">{{$document->name}}</div>
                        <div class="doc-date">{{date('d.m.Y H:i', strtotime($document->created_at))}}</div>
                        <div class="doc-download">
                            <a href="{{$document->path}}" target="_blank">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M7.9903 0.491043C7.82468 0.493631 7.66686 0.561849 7.5515 0.680715C7.43615 0.799581 7.37269 0.959374 7.37506 1.12499V10.0329L5.94196 8.59977C5.8837 8.53977 5.814 8.49208 5.73698 8.45951C5.65995 8.42694 5.57718 8.41015 5.49355 8.41015C5.36917 8.41018 5.24762 8.44732 5.14446 8.51682C5.04131 8.58632 4.96123 8.68501 4.91448 8.80027C4.86773 8.91554 4.85642 9.04213 4.88202 9.16385C4.90762 9.28557 4.96895 9.39689 5.05817 9.48356L7.55817 11.9836C7.67538 12.1007 7.83433 12.1665 8.00006 12.1665C8.1658 12.1665 8.32474 12.1007 8.44196 11.9836L10.942 9.48356C11.0019 9.42597 11.0498 9.35699 11.0828 9.28065C11.1158 9.20432 11.1332 9.12218 11.1341 9.03903C11.1349 8.95588 11.1192 8.8734 11.0877 8.79641C11.0563 8.71943 11.0098 8.64949 10.951 8.59069C10.8922 8.53189 10.8223 8.48542 10.7453 8.45399C10.6683 8.42255 10.5858 8.4068 10.5027 8.40765C10.4195 8.40849 10.3374 8.42592 10.2611 8.45891C10.1847 8.4919 10.1158 8.53979 10.0582 8.59977L8.62506 10.0329V1.12499C8.62626 1.04134 8.61066 0.958301 8.57917 0.88079C8.54769 0.80328 8.50096 0.732879 8.44177 0.67376C8.38257 0.614641 8.31211 0.568006 8.23456 0.53662C8.15701 0.505234 8.07395 0.489736 7.9903 0.491043ZM1.1153 10.9077C0.94968 10.9103 0.791861 10.9785 0.676504 11.0974C0.561148 11.2162 0.497689 11.376 0.500064 11.5417V13.2083C0.500064 14.4666 1.53349 15.5 2.79173 15.5H13.2084C14.4666 15.5 15.5001 14.4666 15.5001 13.2083V11.5417C15.5012 11.4588 15.4859 11.3766 15.4551 11.2998C15.4242 11.2229 15.3783 11.153 15.3202 11.094C15.262 11.035 15.1927 10.9882 15.1163 10.9562C15.0399 10.9242 14.9579 10.9078 14.8751 10.9078C14.7922 10.9078 14.7102 10.9242 14.6338 10.9562C14.5574 10.9882 14.4881 11.035 14.43 11.094C14.3718 11.153 14.326 11.2229 14.2951 11.2998C14.2642 11.3766 14.2489 11.4588 14.2501 11.5417V13.2083C14.2501 13.7909 13.791 14.25 13.2084 14.25H2.79173C2.20914 14.25 1.75006 13.7909 1.75006 13.2083V11.5417C1.75126 11.458 1.73566 11.375 1.70417 11.2975C1.67269 11.2199 1.62596 11.1495 1.56677 11.0904C1.50757 11.0313 1.43711 10.9847 1.35956 10.9533C1.28201 10.9219 1.19895 10.9064 1.1153 10.9077Z"
                                        fill="black"/>
                                </svg>
                            </a>
                        </div>
                        <div class="subscribes">
                            @if($document->is_sign && !$document->sign_status)
                                <a href="{{route('sign_document', $document->id)}}">Подписать</a>
                            @elseif($document->is_sign && $document->sign_status)
                                <span>
                            Документ подписан {{date('d.m.Y H:i', strtotime($document->updated_at))}}
                        </span>
                            @endif
                        </div>
                    </div>
                @endforeach
            </div>
            <div id="tab-content2" class="tab-content doc-tabs green-panels">
                @foreach(Auth::user()->getNoSignDocuments() as $document)
                    <div class="row  m-0 doc-row">
                        <div class="doc-name">{{$document->name}}</div>
                        <div class="doc-date">{{date('Y-m-d H:i', strtotime($document->updated_at))}}</div>
                        <div class="doc-download">
                            <a href="{{$document->path}}">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M7.9903 0.491043C7.82468 0.493631 7.66686 0.561849 7.5515 0.680715C7.43615 0.799581 7.37269 0.959374 7.37506 1.12499V10.0329L5.94196 8.59977C5.8837 8.53977 5.814 8.49208 5.73698 8.45951C5.65995 8.42694 5.57718 8.41015 5.49355 8.41015C5.36917 8.41018 5.24762 8.44732 5.14446 8.51682C5.04131 8.58632 4.96123 8.68501 4.91448 8.80027C4.86773 8.91554 4.85642 9.04213 4.88202 9.16385C4.90762 9.28557 4.96895 9.39689 5.05817 9.48356L7.55817 11.9836C7.67538 12.1007 7.83433 12.1665 8.00006 12.1665C8.1658 12.1665 8.32474 12.1007 8.44196 11.9836L10.942 9.48356C11.0019 9.42597 11.0498 9.35699 11.0828 9.28065C11.1158 9.20432 11.1332 9.12218 11.1341 9.03903C11.1349 8.95588 11.1192 8.8734 11.0877 8.79641C11.0563 8.71943 11.0098 8.64949 10.951 8.59069C10.8922 8.53189 10.8223 8.48542 10.7453 8.45399C10.6683 8.42255 10.5858 8.4068 10.5027 8.40765C10.4195 8.40849 10.3374 8.42592 10.2611 8.45891C10.1847 8.4919 10.1158 8.53979 10.0582 8.59977L8.62506 10.0329V1.12499C8.62626 1.04134 8.61066 0.958301 8.57917 0.88079C8.54769 0.80328 8.50096 0.732879 8.44177 0.67376C8.38257 0.614641 8.31211 0.568006 8.23456 0.53662C8.15701 0.505234 8.07395 0.489736 7.9903 0.491043ZM1.1153 10.9077C0.94968 10.9103 0.791861 10.9785 0.676504 11.0974C0.561148 11.2162 0.497689 11.376 0.500064 11.5417V13.2083C0.500064 14.4666 1.53349 15.5 2.79173 15.5H13.2084C14.4666 15.5 15.5001 14.4666 15.5001 13.2083V11.5417C15.5012 11.4588 15.4859 11.3766 15.4551 11.2998C15.4242 11.2229 15.3783 11.153 15.3202 11.094C15.262 11.035 15.1927 10.9882 15.1163 10.9562C15.0399 10.9242 14.9579 10.9078 14.8751 10.9078C14.7922 10.9078 14.7102 10.9242 14.6338 10.9562C14.5574 10.9882 14.4881 11.035 14.43 11.094C14.3718 11.153 14.326 11.2229 14.2951 11.2998C14.2642 11.3766 14.2489 11.4588 14.2501 11.5417V13.2083C14.2501 13.7909 13.791 14.25 13.2084 14.25H2.79173C2.20914 14.25 1.75006 13.7909 1.75006 13.2083V11.5417C1.75126 11.458 1.73566 11.375 1.70417 11.2975C1.67269 11.2199 1.62596 11.1495 1.56677 11.0904C1.50757 11.0313 1.43711 10.9847 1.35956 10.9533C1.28201 10.9219 1.19895 10.9064 1.1153 10.9077Z"
                                        fill="black"/>
                                </svg>
                            </a>
                        </div>
                        <div class="subscribes">
                            <a href="{{route('sign_document', $document->id)}}">Подписать</a>
                        </div>
                    </div>
                @endforeach
            </div>
        </div>
@stop
